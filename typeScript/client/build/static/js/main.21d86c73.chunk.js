(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{101:function(e,t,s){"use strict";s.r(t);var a=s(0),n=s.n(a),c=s(25),l=s.n(c),i=(s(58),s(59),s(60),s(9)),r=s(36),o=s(22),u=Object(o.b)({name:"list",initialState:{list:[],lastTask:"",countOfActiveTasks:0,filter:"all",filterResult:[],error:null},reducers:{setTodos:function(e,t){var s=t.payload,a=s.list,n=s.lastTask;e.list=a,e.lastTask=n,e.filterResult=a,e.countOfActiveTasks=a.filter((function(e){return"active"===e.status})).length,e.error=null},changeItemStatus:function(e,t){var s=e.list.findIndex((function(e){return e.id===t.payload.id}));"active"===e.list[s].status?e.list[s].status="completed":e.list[s].status="active",e.countOfActiveTasks=e.list.filter((function(e){return"active"===e.status})).length,e.filterResult=e.list,e.filter="all",e.error=null},changeEditing:function(e,t){var s=t.payload,a=s.id,n=s.caseType,c=e.list.find((function(e){return e.id===a}));c&&(c.editing=n&&!c.editing),e.filterResult=e.list},setChangedTask:function(e,t){var s=t.payload,a=s.id,n=s.task;e.list=e.list.map((function(e){return e.id===a?Object(r.a)(Object(r.a)({},e),{},{task:n}):e})),e.filterResult=e.list},changeItemTask:function(e,t){var s=t.payload,a=s.id,n=s.task,c=e.list.find((function(e){return e.id===a}));c&&(c.task=n),e.filterResult=e.list,e.error=null},addItem:function(e,t){if(e.lastTask){var s=t.payload.task,a=e.list.length>0?e.list[e.list.length-1].id+1:1;e.list.push({id:a,task:s,status:"active",editing:!1}),e.lastTask="",e.countOfActiveTasks+=1,e.filterResult=e.list,e.filter="all"}e.error=null},deleteItem:function(e,t){e.list=e.list.filter((function(e){return e.id!==t.payload.id})),e.countOfActiveTasks=e.list.filter((function(e){return"active"===e.status})).length,e.filterResult=e.list,e.filter="all",e.error=null},deleteCompleted:function(e){e.list=e.list.filter((function(e){return"completed"!==e.status})),e.filterResult=e.list,e.error=null},changeLastTask:function(e,t){e.lastTask=t.payload.task,e.error=null},completedAll:function(e){e.list.every((function(e){return"active"===e.status}))||e.list.some((function(e){return"active"===e.status}))?(e.list.forEach((function(e){e.status="completed"})),e.countOfActiveTasks=0):(e.list.forEach((function(e){e.status="active"})),e.countOfActiveTasks=e.list.length),e.filterResult=e.list,e.error=null},changeFilter:function(e,t){switch(t.payload.filter){case"all":e.filterResult=e.list,e.filter="all";break;case"active":e.filterResult=e.list.filter((function(e){return"completed"!==e.status})),e.filter="active";break;case"completed":e.filterResult=e.list.filter((function(e){return"active"!==e.status})),e.filter="completed";break;case"item":e.filterResult=e.list.filter((function(e){return e.id===t.payload.id})),e.filter="all";break;default:return}e.countOfActiveTasks=e.list.filter((function(e){return"active"===e.status})).length,e.error=null},setErrorResponse:function(e,t){e.error=t.payload.error}}}),d=function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a={method:t,headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json"}};return 0!==Object.keys(s).length&&(a.body=JSON.stringify(s)),fetch(e,a)},f=u.actions,b=f.setTodos,j=f.changeItemStatus,h=f.changeItemTask,m=f.changeEditing,g=f.setChangedTask,k=f.addItem,p=f.deleteItem,O=f.deleteCompleted,v=f.changeLastTask,T=f.completedAll,C=f.changeFilter,x=f.setErrorResponse,E=s(15),I=s(3),R=s(1),y=function(e){var t=e.item,s=e.changeEditingCall,c=e.changeItemStatusCall,l=e.deleteItemCall,i=e.changeItemTaskCall,r=n.a.createRef(),o=t.task,u=Object(a.useCallback)((function(){s(t.id,!0,o,t.editing)}),[s,t]),d=Object(a.useCallback)((function(){c(t.id)}),[c,t]),f=Object(a.useCallback)((function(){l(t.id)}),[l,t]),b=Object(a.useCallback)((function(e){i(t.id,e.currentTarget.value),o=e.currentTarget.value}),[i,t]),j=Object(a.useCallback)((function(e){s(t.id,!1,e.currentTarget.value,t.editing)}),[s,t]);return Object(a.useEffect)((function(){r.current&&r.current.focus()}),[r]),Object(R.jsxs)("li",{className:"completed"===t.status?t.editing?"completed editing":"completed":t.editing?"editing":void 0,onDoubleClick:u,children:[Object(R.jsxs)("div",{className:"view",children:[Object(R.jsx)("input",{className:"toggle",type:"checkbox",checked:"completed"===t.status,onChange:d}),Object(R.jsx)("label",{children:t.task}),Object(R.jsx)("button",{className:"destroy",onClick:f})]}),Object(R.jsx)("input",{className:"edit",value:t.task,onInput:b,onBlur:j,ref:r})]})},N=s(53),A=s.n(N)()("http://localhost:8000/"),w={changeEditing:m,changeItemStatus:j,changeItemTask:h,completedAll:T,deleteItem:p,setChangedTask:g,setErrorResponse:x,getUsersTC:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return function(a){d("/api/all","GET").then((function(n){var c=n.json();200===n.status?c.then((function(n){a(b({list:n.list,lastTask:n.lastTask})),a(C({filter:e,id:t})),s&&a(m({id:t}))})):c.then((function(e){a(x({error:e.message}))}))}))}}},S=Object(E.b)((function(e){return{filterResult:e.toDo.filterResult}}),w)((function(e){var t=e.filterResult,s=e.changeEditing,n=e.changeItemStatus,c=e.changeItemTask,l=e.completedAll,r=e.deleteItem,o=e.setChangedTask,u=e.setErrorResponse,f=e.getUsersTC,b=Object(I.e)(),j=b.filter,h=b.num,m=b.edit;Object(a.useEffect)((function(){switch(j){case"todo":h&&!m?f("item",Number(h)):h&&m?f("item",Number(h),!0):f("all");break;case void 0:f("all");break;default:f(j)}}),[m,h,j]),Object(a.useEffect)((function(){A.on("all:wasCompleted",(function(e){var t=e.success,s=Object(i.a)(e,["success"]);t?l():u({error:s.message})})),A.on("todo:wasDeleted",(function(e){var t=e.id,s=e.success,a=Object(i.a)(e,["id","success"]);s?r({id:t}):u({error:a.message})})),A.on("todoStatus:wasChanged",(function(e){var t=e.id,s=e.success,a=Object(i.a)(e,["id","success"]);s?n({id:t}):u({error:a.message})})),A.on("todo:wasChanged",(function(e){var t=e.success,s=e.id,a=e.task,n=Object(i.a)(e,["success","id","task"]);t?o({id:s,task:a}):u({error:n.message})}))}),[]);var g=Object(a.useCallback)((function(){d("/api/completeAll","GET")}),[]),k=Object(a.useCallback)((function(e){!function(e){d("/api/changeTodo","DELETE",{id:e})}(e)}),[]),p=Object(a.useCallback)((function(e){!function(e){d("/api/changeTodo","PUT",{id:e})}(e)}),[]),O=Object(a.useCallback)((function(e,t,a,n){n?(!function(e,t){d("/api/changeTodo","POST",{id:e,task:t})}(e,a),s({id:e,caseType:t})):s({id:e,caseType:t})}),[]),v=Object(a.useCallback)((function(e,t){c({id:e,task:t})}),[]);return Object(R.jsxs)("section",{className:"main",children:[Object(R.jsx)("input",{id:"toggle-all",className:"toggle-all",type:"checkbox",onClick:g}),Object(R.jsx)("label",{htmlFor:"toggle-all",children:" Mark all as complete"}),Object(R.jsx)("ul",{className:"todo-list",children:t.map((function(e){return Object(R.jsx)(y,{item:e,changeEditingCall:O,changeItemStatusCall:p,deleteItemCall:k,changeItemTaskCall:v},e.id)}))})]})})),D=s(16),L={deleteCompleted:O,setErrorResponse:x},F=Object(E.b)((function(e){return{countOfActiveTasks:e.toDo.countOfActiveTasks}}),L)((function(e){var t=e.countOfActiveTasks,s=e.deleteCompleted,n=e.setErrorResponse;Object(a.useEffect)((function(){A.on("completed:wasDeleted",(function(e){var t=e.success,a=Object(i.a)(e,["success"]);t?s():n({error:a.message})}))}),[]);var c=Object(a.useCallback)((function(){d("/api/deleteCompleted","DELETE")}),[]);return Object(R.jsxs)("footer",{className:"footer",children:[Object(R.jsxs)("span",{className:"todo-count",children:[Object(R.jsx)("strong",{children:t})," item left"]}),Object(R.jsxs)("ul",{className:"filters",children:[Object(R.jsx)("li",{children:Object(R.jsx)(D.b,{activeClassName:"selected",to:"/todo",children:"All"})}),Object(R.jsx)("li",{children:Object(R.jsx)(D.b,{activeClassName:"selected",to:"/active",children:"Active"})}),Object(R.jsx)("li",{children:Object(R.jsx)(D.b,{activeClassName:"selected",to:"/completed",children:"Completed"})})]}),Object(R.jsx)("button",{className:"clear-completed",onClick:c,children:"Clear completed"})]})})),_=s(8),P=Object(_.c)({toDo:u.reducer}),U=Object(o.c)({thunk:!0}),B=Object(o.a)({reducer:P,middleware:U}),H=s(35),J=s.n(H),M={addItem:k,changeLastTask:v,setErrorResponse:x},W=Object(E.b)((function(e){return{lastTask:e.toDo.lastTask,error:e.toDo.error}}),M)((function(e){var t=e.addItem,s=e.changeLastTask,n=e.setErrorResponse,c=e.lastTask,l=e.error;Object(a.useEffect)((function(){A.on("newTodo:wasChanged",(function(e){var t=e.task,a=e.success,c=Object(i.a)(e,["task","success"]);a?s({task:t}):n({error:c.message})})),A.on("newTodo:wasAdded",(function(e){var s=e.success,a=e.task,c=Object(i.a)(e,["success","task"]);s?t({task:a}):n({error:c.message})}))}),[]);var r=Object(a.useCallback)((function(e){"Enter"===e.key&&function(e){d("/api/newTodo","POST",{task:e})}(c)}),[c]),o=Object(a.useCallback)((function(e){var t;t=e.target.value,d("/api/lastTask","PUT",{text:t})}),[]);return Object(R.jsxs)("header",{className:"header ".concat(J.a.header),children:[Object(R.jsx)("h1",{children:"todos"}),l&&Object(R.jsxs)("p",{className:J.a.error,children:["Server error: ",l]}),Object(R.jsx)("input",{className:"new-todo",placeholder:"What needs to be done?",value:c,onInput:o,onKeyDown:r,autoFocus:!0})]})})),X=function(){return Object(R.jsxs)("section",{className:"todoapp",children:[Object(R.jsx)(W,{}),Object(R.jsx)(I.a,{path:"/:filter(active|all|completed|todo)?/:num?/:edit?",render:function(){return Object(R.jsx)(S,{})}}),Object(R.jsx)(F,{})]})},q=function(){return Object(R.jsx)(D.a,{children:Object(R.jsx)(E.a,{store:B,children:Object(R.jsx)(X,{})})})},G=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,102)).then((function(t){var s=t.getCLS,a=t.getFID,n=t.getFCP,c=t.getLCP,l=t.getTTFB;s(e),a(e),n(e),c(e),l(e)}))};l.a.render(Object(R.jsxs)(n.a.StrictMode,{children:[Object(R.jsx)(q,{}),","]}),document.getElementById("root")),G()},35:function(e,t,s){e.exports={error:"Header_error__1X_7W",header:"Header_header__h8UIr"}},58:function(e,t,s){},59:function(e,t,s){},60:function(e,t,s){}},[[101,1,2]]]);
//# sourceMappingURL=main.21d86c73.chunk.js.map